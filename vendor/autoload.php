<?php

// autoload.php @generated by Composer

require_once __DIR__ . '/composer/autoload_real.php';

require_once __DIR__ . '../shuchkin/simplexlsx/src/SimpleXLSX.php';

use Shuchkin\SimpleXLSX;

$download_file = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSUlLBCiA5TRuGQH3m-ih0k93mVIj39cgf7XvcaMZweyDS37DnZX8g-k-qxLcUCCQ/pub?output=xlsx";

$download = file_get_contents($download_file);

file_put_contents("data.xlsx", $download);

if ( $xlsx = SimpleXLSX::parse('data.xlsx') ) {
    $data_excel = $xlsx->rows();
    
    $data_all = array_slice($data_excel, 1);
    $data = array_slice($data_all, 2, 50);
    $data = array_map(function($row) {
        return [
            'rank' => $row[0],
            'nama' => $row[1],
            'uts' => $row[4],
            'workshop' => $row[5],
            'sharing1' => $row[6],
            'pengabdian' => $row[7],
            'sharing2' => $row[8],
            'uas' => $row[9],
            'score' => $row[12],
        ];
    }, $data);

    usort($data, function($a, $b) {
        return $b['score'] - $a['score'];
    });

    $rank = 1;
    foreach ($data as $key => $value) {
        $data[$key]['rank'] = $rank;
        $rank++;
    }

} else {
    echo SimpleXLSX::parseError();
}


echo '1';



return ComposerAutoloaderInit6c85d5d5d2647baa3f8de71623038ec6::getLoader();
